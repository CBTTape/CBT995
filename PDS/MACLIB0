./ ADD NAME=BLPRWA,SSI=00000168
         MACRO
         BLPRWA
BLPRWA   DSECT
         SPACE
WAFLAG1  DS    X
         SPACE
WALOWCOL EQU   X'80'              LOW COL SPECIFIED
WAHICOL  EQU   X'40'              HI COLUMN SPECIFIED
WAFMRKN  EQU   X'20'              LIST MARKER
WAFTWLN  EQU   X'10'
WAF2LNS  EQU   X'08'              LIST TWOLINES
WAFSQUSH EQU   X'04'              LIST SQUSHED
WAFCAN   EQU   X'02'              CANCEL RUN
WAFOFF   EQU   X'01'
         SPACE
WAFLAG2  DS    X
         SPACE 3
WAMRKCH  DS    CL1
WA2LNCH  DS    CL1
JOBNUM   DS    CL8
JOBNAM   DS    CL8
REASON   DS    CL4
WAOFFCNT DS    F
         DS    0F
WASIZE   EQU   *-BLPRWA
         MEND
./ ADD NAME=CPTSO,SSI=00000176
* WYLTSO LINE EDITOR CONTROL PAGE
         SPACE ,
*                                                               JEP005
*                                                               JEP005
* MODIFIED AT DCEC TO INCORPORATE UPPER AND LOWER OPERANDS      JEP005
* ON THE CHANGE CMD FOR CHANGING CASE OF TEXT.                  JEP005
*                                                               JEP004
*                                                               JEP004
* MODIFIED AT DCEC TO ENABLE RECOGNITION OF 3277 TERMINALS.     JEP004
* ACCOMPLISHED IN LFLG1. JERRY PITTENGER                        JEP004
*                                                               JEP010
*                                                               JEP010
* MODIFIED AT DCEC TO ALLOW FOR FOUR LOCAL FLAGS (LFLG1-4).     JEP010
*                                                               JEP001
*                                                               JEP001
* MODIFIED AT DCEC TO ALLOW FOR UP TO 7 CHAR. LOGON ID.         JEP001
*                                                               JEP001
*                                                               JEP017
* MODIFIED AT DCEC TO DOUBLE THE EXEC FILE SIZE.                JEP017
*                                                               JEP017
CPSTART  DS    0D
CPR13    DS    A                       REGISTERS
CPR14    DS    A
CPR15    DS    A
CPR0     DS    A
CPR1     DS    A
CPR2     DS    A
CPR3     DS    A
CPR4     DS    A
CPR5     DS    A
CPR6     DS    A
CPR7     DS    A
CPR8     DS    A
         SPACE 3
* REMOTE TERMINAL BUFFER
         SPACE ,
RTBSTART DC    0F'0'
RTBTABS  DC    XL8'00'             TABS
         SPACE 2
RTBMFL   DC    AL1(0)              MODE FLAG
         SPACE ,
RTBMFUC  EQU   X'80'               UPPER-CASE ONLY
RTBMFNA  EQU   X'40'               NO WRITE ATTN
RTBMFCL  EQU   X'20'               CLEAN LISTING
RTBMFNTO EQU   X'10'               NO TABS IN OUTPUT
RTBNOCR  EQU   X'08'               NO CARRIAGE RETURNS
RTBNOTR  EQU   X'04'               NO TRANSLATE TABLE
RTBWRAP  EQU   X'02'               CR/LF NEEDED FOR WRAPPING
RTBCRT   EQU   X'01'               PAGING IS TO BE DONE
         SPACE 2
RTBSFL   DC    X'00'       STATUS FLAGS
         SPACE ,
RTBSFEND EQU   X'C0'       ENDING STATUS, 00=OK, 01=ATTN, 11=I/O ERROR
RTBSFATN EQU   X'40'       ATTENTION
RTBSFERR EQU   X'C0'       I/O ERROR
RTBSFUST EQU   X'20'       UNSET TAB
RTBSFBRK EQU   X'10'       ENDED BY BREAK
RTBSFHU  EQU   X'08'       HUNG UP PHONE
         SPACE ,
RTBWC    DC    H'0'        WRITE COUNT
RTBPC    DC    H'0'        PROMPT COUNT
RTBRC    DC    H'0'        READ COUNT
         SPACE ,
RTBNTEXT EQU   168         SIZE OF TEXT BUFFER
RTBPMAX  EQU   32          MAX LENGTH FOR PROMPT
         SPACE ,
RTBWAPTR DS    F           RTB WORK AREA POINTER (256 BYTES)
RTBATNSZ EQU   0           2 BYTES: ATTN SEQ LENGTH
RTBATTN  EQU   2           8 BYTES: ATTN SEQ
RTBPSZ   EQU   10          2 BYTES: PAGE SIZE
RTBLSZ   EQU   12          2 BYTES: LINE SIZE
RTBLINE  EQU   14          2 BYTES: LINES PRINTED
RTBCURS  EQU   16          2 BYTES: CHARS PRINTED
RTBBSCNT EQU   18          2 BYTES: BS COUNTER FOR TABS
RTBTRBUF EQU   20        168 BYTES: TRANSLATE BUFFER
RTBPRMPT EQU   188        32 BYTES: REPROMPT BUFFER
RTBSAVE  EQU   220         2 BYTES: SAVE BUFFER FOR CR/LF
*        EQU   222        26 BYTES: STILL AVAILABLE
RTBPAUS  EQU   248         8 BYTES: CRT PAUSE READ BUFFER
         SPACE 2
RTBUFL   DS    X
         SPACE ,
RTBUATTN EQU   X'80'       ATTN SEQUENCE EXISTS
RTBUNCOL EQU   X'40'       AUTOMATIC COLLECT NOT HONORED
RTBUPAD  EQU   X'20'       PAD WHEN LISTING NOCR
RTBURELT EQU   X'10'       TABS ARE RELATIVE
RTBUBACK EQU   X'08'       BACKSPACE IS A GOOD CHARACTER
RTBUFAST EQU   X'04'       FASTLIST IN EFFECT
RTBUTBUN EQU   X'02'       TABS ARE UNNUMBERED
         SPACE ,
         DS    3X          MORE SPACE AVAILABLE
         DC    0F'0'     FULL WORD FOR ORVYL-WYLBUR
RTBTEXT  DC    CL(RTBNTEXT)' ' TEXT BUFFER
         DC    0F'0'
         SPACE ,
RTBSIZE  EQU   *-RTBSTART
         SPACE 3
CPRTBSZ  EQU   RTBSIZE                 SIZE OF RTB
CPSCANSZ EQU   24                      SIZE OF SCAN AREA
CPSCAN   DS    0F,(CPSCANSZ)X          SCANNER WORK AREA
         SPACE ,
* FOR THE TEXT-EDITOR
CPGLDL   DS    1F   GLOBAL DELTA
CPHIPS   DS    1F   HIGHEST POSITION YET REACHED  * MUST
CPLNCT   DS    1H   LINE COUNT                    *STAY
CPAGCT   DS    1H   PAGE COUNT                    * TOGETHER
CPLNGTH  DS    1H   LINE LENGTH OPTION
         SPACE 2
CPGFLG   DS    1X      GLOBAL FLAG BYTE
         SPACE ,
CPFOPN   EQU   X'80'   EXTERNAL DATA SET OPEN FLAG
CPFCMOFF EQU   X'40'   TERSE MODE FLAG FOR NORMAL MESSAGES
CPFUPLW  EQU   X'20'   UPPER-LOWER CASE FLAG
CPFVOLM  EQU   X'10'   DEFAULT VOLUME SET FLAG
CPFDIRCH EQU   X'08'   DIRECTORY HAS CHANGED
CPFRETRY EQU   X'04'   COMMAND RETRY GOING ON
CPFRETOK EQU   X'02'   COMMAND RETRY CAN BE DONE
         SPACE 2
CPGFLG2  DS    1X      GLOBAL FLAG BYTE
         SPACE ,
CPFEXEC  EQU   X'80'   TAKE COMMANDS FROM EXEC FILE
CPFNOLOG EQU   X'40'   DON'T LOG COMMANDS FROM EXEC FILE
CPFEXTER EQU   X'20'   EXEC MODE TERSE FLAG
CPSKNULL EQU   X'04'   SKIP CHARACTER IS NULL FLAG
CPESNULL EQU   X'02'   ESCAPE CHARACTER IS NULL FLAG
         SPACE ,
CPDOUB   DS    1D   DOUBLE-WORD WORK
CPHFWRD  DS    H    USED TO EXTEND CPDOUB TO 10 BYTES
CPVOLSV  DS    CL6  DEFAULT VOLUME SAVE AREA
         SPACE ,
CPLSTCOL DS    1F   NEXT LINE NO. TO COLLECT
CPDLTCOL DS    1F   DELTA FOR COLLECT
         SPACE ,
CPEXLINE DS    F    EXEC FILE LINE NUMBER
CPEXHIPS DS    F    HIGHEST LINENO IN EXEC FILE   * MUST
CPEXLNCT DS    H    EXEC FILE LINE COUNT          * STAY
CPEXCNT  DS    H    COUNT OF PAGES IN EXEC FILE   * TOGETHER
CPEXCMCT DS    H    EXEC COMMAND COUNT WITHOUT USING TYPEWRITER
*PEXDIR  DS     5CL6   EXEC FILE DIRECTORY SPACE                JEP017
CPEXDIR  DS   20CL6    EXEC FILE DIRECTORY SPACE                JEP017
CPEXECMX EQU   (*-CPEXDIR)/6 MAX NO. OF PAGES IN EXEC FILE
         SPACE ,
CPCURRL  DS    F   CURRENT LINE POINTER
         SPACE ,
CPPFXL   DS    H                       LENGTH OF PREFIX
         SPACE ,
CPPFXSZ  EQU   36                      SIZE OF PREFIX AREA
CPPFX    DS    CL(CPPFXSZ)             PREFIX AREA
         SPACE ,
CPUSER   DS    CL3                 SIGNED ON USER
CPGRP    DS    CL5                 SIGNED ON GROUP              JEP001
CPUSERSV DS    CL3                 SAVE USER ID FOR DSNAMES
CPGRPSV  DS    CL5                 SAVE GROUP ID FOR DSNAMES    JEP001
CPMEMBSV DS    CL8                 SAVE MEMBER NAME FOR DSNAMES
CPSTCNT  DS    H                   STOWIT MOD COUNT FOR RECOVERY
CPRCVSZ1 EQU   *-CPGLDL            SIZE OF RECOVERY INFO
         EJECT
* LOCAL ITEMS FOR COMMANDS
         DS    0F
CPCMNM   DS    XL3  FOR FIRST 3 BYTES OF CURRENT COMMAND NAME
         SPACE 2
CPLFLG1  DS    1X      FIRST LOCAL FLAG BYTE
         SPACE ,
CPFTMINF EQU   X'80'   SHOW INFO/TIME FLAG
CPFNOTRG EQU   X'80'   "NOT" LOGIC FOR RANGE
CPFCPY   EQU   X'20'   COPY FLAG
CPFALL   EQU   X'10'   FLAG FOR DETRNG|-- DEFAULT ALL OKAY
CPFUSCAT EQU   X'04'   USE CATALOG TO LOCATE VOLUME
CPFTNOV  EQU   X'01'   NOVERIFY OF SET TABS
         SPACE ,
* NUMBER USAGE
CPFNMOD  EQU   X'02'   REMAINDER IN TIMES OPTION
CPFTIMES EQU   X'01'   TIMES OPTION FOR NUMBER
         SPACE 2
CPLFLG2  DS    1X      SECOND LOCAL FLAG BYTE
         SPACE ,
CPFMODCD EQU   X'80'   MODIFY MODE -- USED IN MODIFY/EDIT
CPFSCRTC EQU   X'40'   SCRATCH FLAG (SAVE-SHOW DSNAMES)
CPFDSNMS EQU   X'20'   NULL/NO DEFAULT OK ON DSNAMES FLAG
CPFSING  EQU   X'10'   SINGLE PROMPT MODE -- MODIFY/EDIT
CPFCLEAR EQU   X'10'   CLEAR ACTIVE FILE FLAG
CPFCOMB  EQU   X'08'   COMBINE FLAG FOR COPY
CPFMERG  EQU   X'04'   MERGE FLAG FOR COPY/MOVE/COLLECT
CPFREP1  EQU   X'02'   REPLACE CONTROL FLAG
CPFDITTO EQU   X'01'   DITTO CONTROL FLAG (REPLACE & INSERT)
CPFSMALL EQU   X'01'   SMALL DATA SET SAVED (SAVE)
         SPACE ,
* EXEC USAGE
CPFEXLNE EQU   X'08'   EXPLICIT LINENO WAS SPECIFIED
CPFEXACT EQU   X'04'   EXEC ACTIVE WAS SPECIFIED
CPFEXPA  EQU   X'02'   EXEC PAUSE WAS SPECIFIED
CPFEXFR  EQU   X'01'   EXEC FROM WAS SPECIFIED
         SPACE ,
* CHANGE USAGE
CPFCHLIM EQU   X'20'   STRING POSITIONALLY DELIMITED
CPFCHDEL EQU   X'10'   REPLACING STRING VOID FLAG
CPFCHNGD EQU   X'08'   SOMETHING CHANGED FLAG
CPFLNCHN EQU   X'04'   AT LEAST 1 LINE CHANGED FLAG
CPFCHPOS EQU   X'02'   POSITIONAL CHANGE
CPFCHND  EQU   X'01'   TERMINATE CHANGE FLAG
         SPACE ,
* SHOW DSNAMES & CONSOLE MSGS USAGE
CPFSTOP  EQU   X'01'   STOP 2741 LIST FLAG FOR DSNAMES & CONSOLE MSGS
         SPACE ,
* READ USAGE
CPFRDNO  EQU   X'02'   LINE NUMBER FLAG FOR READ
CPFRDEL  EQU   X'01'   DELETE LINE AFTER READ FLAG
         SPACE ,
* SHOW SIZE USAGE
CPFFIRST EQU   X'01'   TURNS ON 'NOT FIRST TIME' FLAG
CPFCOUNT EQU   X'02'   TURNS ON 'DONT DISPLAY COUNT FLAG'
         SPACE 2
CPLFLG3  DS    X       THIRD LOCAL FLAG BYTE
         SPACE ,
CPFSET   EQU   X'80'   SET PREFIX AFTER SCAN (USE-SAVE-COPY-SCR)
CPFDSCLG EQU   X'40'   CATALOG DATA SET (SAVE AND MISC)
CPFUNCLG EQU   X'20'   UNCATALOG DATA SET (SAVE AND MISC)
CPFRECLG EQU   CPFDSCLG+CPFUNCLG  (SAVE AND MISC)
         SPACE ,
* SHOW DSNAMES/DIRECTORY USAGE
CPFPROTF EQU   X'20'   PROTECT OPTION FLAG
CPFDATED EQU   X'10'   DATED OPTION FLAG
CPFEXCL  EQU   X'08'   EXCLUDE OPTION FLAG
CPFSPACE EQU   X'04'   SPACE OPTION FLAG
CPFTYPE  EQU   X'02'   TYPE/ALL OPTION FLAG (SHOW DSN/DIR RESP.)
         SPACE ,
* SHOW DSNAMES/DIRECTORY - PUT USAGE
CPFPUT   EQU   X'01'   PUT IN ACTIVE FILE
CPFNOL   EQU   X'40'   PUT AND DONT LIST
CPFPUTER EQU   X'08'   ERROR IN STOWING
CPFPMSG  EQU   X'80'   GAVE PAGE SHRTGE MSG ALREADY
         SPACE ,
* CHANGE USAGE
CPFCHIN  EQU   X'80'   RANGE SPECIFIED
CPFCHUS  EQU   X'40'   CHANGE USING
CPFCHTO  EQU   X'20'   CHANGE TO
CPFCHNM  EQU   X'10'   CHANGE TO NUMBERS
CPFCHNMI EQU   X'08'   INCREMENT NUMBER FLAG
CPFCHLN  EQU   X'04'   LINE OPTION
CPFCHREP EQU   X'02'   REPEAT OPTION FOR USING RANGE
CPFCHALL EQU   X'01'    CHANGE ALL COLS TO UPPER OR LOWER       JEP005
         SPACE ,
* LIST USAGE
CPFCLEAN EQU   X'80'   CLEAN LIST
         SPACE ,
* CPLBYT1 & CPLBYT2 NO LONGER USED BY LIST OR CHANGE
         SPACE 2
CPLFLG4  DS    1X      FOURTH LOCAL FLAG BYTE
         SPACE ,
CPFSTSPL EQU   X'80'   PAGE SPLIT AT LINE NUMBER FLAG FOR STOWIT
CPFSTINS EQU   X'40'   ALLOW INSERT ONLY FLAG FOR STOWIT
CPFDESET EQU   X'20'   THIS FLAG SIGNALS TO DESPOT THAT THE
*                      VALUE OF CPNWLN HAS BEEN SET FOR THE NEXT
*                      LOCATE AND SHOULD NOT BE KICKED UP.
         SPACE ,
CPFDESRT EQU   X'10'   RE-ENTRY TO DESPOT -- DON'T RESET RANGE
*                      THIS ALLOWS RUN TO HANDLE DISJOINT RANGES AND
*                      COUNT RANGES PROPERLY BUT IT DOES PROHIBIT
*                      OCCURRENCE COUNTS FOR ASSOCIATIVE RANGES
*                      AS WELL AS RE-USE OF THE RANGE AFTER RETURN
*                      FROM DESPOT
CPFCHUP  EQU   X'08'   USED BY CHANGE TO UPPER                  JEP005
CPFCHLO  EQU   X'04'   USED BY CHANGE TO LOWER                  JEP005
         SPACE ,
CPFNOCUR EQU   X'02'   NO ABORT IF CURRENT, NEXT, OR PREVIOUS
*                      DO NOT EXIST
         SPACE ,
CPFNOINC EQU   X'01'   NO INCREMENT ON LINE NUMBERS
         SPACE 2
CPLFLG5  DS    1X   FIFTH LOCAL FLAG BYTE
         SPACE ,
* COMMON FLAG BITS OF CPLFLG5 USED BY MANY COMMANDS
CPFUNUM  EQU   X'80'   UNNUMBERED FLAG
CPFNTEX  EQU   X'40'   NOTEXT LISTING CONTROL FLAG
CPFNONUM EQU   CPFUNUM+CPFNTEX NONUMBER LISTING CONTROL FLAG
CPFNLST  EQU   X'20'   NOLIST LISTING CONTROL FLAG
CPFFOPT  EQU   X'10'   SET IF ANY NUMBER OPTION SPECIFIED
CPFINT   EQU   X'08'   EXPAND LINE NUMBERS AS INTEGERS FLAG
CPFSELOC EQU   X'06'   RANGE SELECTION FLAG BITS
*              X'00'   USE NORMAL ACTIVE FILE FOR RANGE
*              X'02'   USE EXEC FILE FOR RANGE
*              X'06'   USE EXTERNAL FILE FOR RANGE
CPFSELEX EQU   X'02'   RANGE WILL BE SELECTED FROM EXEC FILE
CPFNCUR  EQU   X'01'   DON'T CHANGE CURRENT LINE POINTER FLAG
         SPACE 3
LFLG1    DS    1X      *****LOCAL FLAG BYTE 1*****              JEP010
CPF3277  EQU   X'01'        3277 RECOGNITION                    JEP004
LFLG2    DS    1X      *****LOCAL FLAG BYTE 2*****              JEP010
LFLG3    DS    1X      *****LOCAL FLAG BYTE 3*****              JEP010
LFLG4    DS    1X      *****LOCAL FLAG BYTE 4*****              JEP010
         SPACE 3                                                JEP010
* CPDRPT - CPLCNO - CPREVLN SET BY LOCATE LINE ROUTINES
CPDRPT   DS    1F      ADDR DIR ENTRY OF LOCATE PG (1ST BYTE=FLAGS)
         SPACE ,
CPFNTYT  EQU   X'80'   NOTHING AT ALL IN USER'S DATA SET YET
CPFHIGH  EQU   X'40'   HIGHER THAN ANY LINE NO. IN USER'S DATA SET YET
CPFPGHI  EQU   X'20'   GTR THAN ANY LINENO ON PG, LESS THAN 1ST ON NEXT
CPFPGLW  EQU   X'10'   FIRST LINE ON PAGE
CPFMTCH  EQU   X'08'   LINE NO. MATCHES EXACTLY A PRE-EXISTING ONE
CPFFSLN  EQU   X'04'   LINE NO. LESS OR EQUAL FIRST OF ALL
CPFPGND  EQU   X'02'   LINE WAS LAST ON A TEXT PAGE
CPFNDDS  EQU   X'01'   LINE WAS LAST IN WORKING DATA SET
         SPACE ,
CPLCNO   DS    1F   INTERNAL LINE NUMBER OF LOCATED LINE
CPREVLN  DS    1F   LINE NO. PREVIOUS TO LOCATED IF ON SAME TEXT PAGE
CPDIRCNT DS    H    RESIDUAL PAGE COUNT AFTER LOCATE
CPGDISP  DS    H    PAGE DISPLACEMENT TO LOCATED LINE
         SPACE ,
* DETRNG SETS CPFSLN-CPLSLN-CPSTLN-CPSTAD-CPCMPST-CPCMPLN-CPMDLN-CPMDAD
         SPACE ,
CPNWLN   DS    1F   USED BY DESPOT TO REMEMBER LINE NO. IT'S AT
CPFSLN   DS    1F   1ST LINE NO. IN RANGE
CPLSLN   DS    1F   LAST LINE NO. IN RANGE
CPCMPST  DS    1F   DISPLACEMENT INTO LINE OF FIELD FOR MATCH
CPCMPLN  DS    1F   LENGTH OF MATCH FIELD
CPSTLN   DS    1F   0=EXPL RNG, POS=LEN ASSOC CHAR STR, NEG=BLANK LINES
CPSTAD   DS    1F   ADDRESS OF CHAR STRING FOR ASSOCIATIVE RANGE
         SPACE ,
* FLAGS FOR CPSTAD (FIRST BYTE)
CPFEXPRG EQU   X'80'   EXPLICIT RANGE FLAG
CPFSTRRG EQU   X'40'   ASSOCIATIVE RANGE FLAG (OVER WHOLE LINE)
CPFLIMRG EQU   X'20'   ASSOCIATIVE RANGE FLAG(OVER SPECIFIED POSITIONS)
CPFONERG EQU   X'10'   START POSITION FOR STRING SPECIFIED FLAG
CPFBLKRG EQU   X'08'   BLANK LINE RANGE FLAG
CPFMODS  EQU   X'04'   MODS SPECIFIED FLAG
CPFDSJNT EQU   X'02'   DISJOINT EXPLICIT RANGE FLAG
CPFSOME  EQU   X'01'   NON-VOID RANGE FLAG
         SPACE ,
* CPMDLN & CPMDAD ALSO USED BY LOCATE AND SHOW COMMANDS
CPMDLN   DS    1F   NO. OF MODS OR NO EXPLICIT LINE NOS IN RANGE (0-10)
CPMDAD   DS    10F  THE MODS OR LINE NOS.
         SPACE ,
* CPDRED FOR USE, SAVE, COPY, RUN, PUNCH, LIST OFFLINE
CPDRED   DS    2F   ADDRESS OF BUFFER FOR EXTERNAL DATA SETS
*              FLAG USED IN CPDRED
CPFSTART EQU   X'F0'   SIGNAL 1ST READ OR NOT
         SPACE ,
* CPWKPS & CPWKDL ARE USED WHERE REQUIRED
         SPACE ,
CPWKPS   DS    1F   WORK POSITION
CPWKDL   DS    1F   WORK DELTA
* AS USED DURING RANGE DETERMINATION
CPTELL   EQU   CPWKPS   (CPWKPS & CPWKDL - USED IN RANGE DETERMINATION)
CPRCVSZ2 EQU   *-CPDRPT
         EJECT
* WORK CELLS FOR LOCAL USE BY TEXT-EDITING COMMANDS
         SPACE ,
CPWK1    DS    1F   WORK CELLS
CPWK2    DS    1F
CPWK3    DS    1F
CPWK4    DS    1F
CPWK5    DS    1F
CPWK6    DS    1F
         SPACE ,
* CPWK1, CPWK2 & CPWK3 USED BY LXCATE (EXTERNAL COPY)
* CPWK4 USED BY MOVE & COPY
* CPWK1, CPWK2 & CPWK3 USED BY SHOW OPERATOR
* CPWK1 USED BY IMMEDIATE DELETE IN BWYL
         SPACE ,
* CPWK6 AS USED BY RUN, PUNCH, SAVE, AND USE
CPSEQFLD EQU   CPWK6   START OF SEQ FIELD FOR NUMBERED
CPSEQLN  EQU   CPWK6+2 LENGTH OF SEQ FIELD FOR NUMBERED
         SPACE ,
* AS USED BY "CHANGE"
         SPACE ,
CPCHCST  EQU   CPWK1   DISPLACEMENT IN LINE OF CHANGE TARGET FIELD
CPCHCLN  EQU   CPWK2   LENGTH OF FIELD
CPCHLN1  EQU   CPWK3   LENGTH OF STRING TO MATCH
CPCHAD1  EQU   CPWK4   IT'S ADDRESS
CPCHMOD  EQU   CPCHAD1 USE FIRST BYTE FOR OCCURRENCE COUNT
CPCHLN2  EQU   CPWK5   LENGTH OF STRING TO USE AS REPLACE
CPCHAD2  EQU   CPWK6   IT'S ADDRESS
         SPACE ,
* AS USED BY "MOVE" & "COPY"
CPBGLN   EQU   CPWK5   1ST LINE NO. OF COPY-MOVE
CPNDLN   EQU   CPWK6   START OF REPLACE/INTERLEAVE ON COPY-MOVE
         SPACE ,
* AS USED BY "USE" & "SAVE"
CPLRCL   EQU   CPWK1   LRECL FOR USE-SAVE
CPNREC   EQU   CPWK2   BLOCKING FACTOR FOR USE-SAVE
CPRCSZ   EQU   CPWK3   BLOCKSIZE FOR USE-SAVE
CPNXAD   EQU   CPWK4   WORK CELL FOR USE-SAVE
CPNWCT   EQU   CPWK5   WORK CELL FOR USE-SAVE
         SPACE ,
* AS USED BY "ALIGN"
CPNAWAPT EQU   CPWK1   WORK AREA ADDR FOR ALIGN
         SPACE ,
* AS USED BY "READ"
CPWKRD   EQU   CPWK1   LINE NUMBER FOR READ COMMAND
         SPACE ,
* AS USED BY "LIST/POINT"
CPSPAC   EQU   CPWK4
* AS USED BY "COLLECT"
CPNXPS   EQU   CPWK1   COMPARE HERE FOR INTERLEAVE OR OVERLAY
         SPACE ,
* AS USED BY "EXEC"
CPEXLNET EQU   CPWK6   SPECIFIED LINE NO. FOR EXEC
         SPACE ,
* AS USED BY SHOW SIZE
CPOVSIZE EQU   CPWK1   WORK CELL FOR SHOW SIZE
         SPACE 3
CPWORK1  DS    F
CPWORK2  DS    F
         SPACE 2
CPSYSFLG DS    X
         SPACE ,
CPFRNGCM EQU   X'40'
CPFTUSXC EQU   X'20'
CPFNTYPD EQU   X'10'
         SPACE ,
CPPROTFL DS    X                   PERMIT FLAGS
         SPACE ,
CPSPARE  DS    1F   1 SPARE  (USED TO BE 2--1 TAKEN FOR FLAGS)  JEP010
         SPACE ,
* PRE-PROC INFO
CPRSCNVL DS    H                   RESCAN VALUE
CPESCAPE DS    X                   ESCAPE CHAR
CPSKIP   DS    X                   SKIP CHAR
         SPACE ,
CPSAVE   DS    2A   SCAN SAVES PTRS LAST ITEM HERE
         EJECT
CPWA     DS    199F                    WORK AREA
         SPACE ,
* FIRST PART OF CPWA USED FOR DSNAME WORK AREA WHEN REQUIRED.
CPDSNWA  EQU   CPWA                DSNAME WORK AREA
         SPACE 2
CPCTSAV  EQU   CPWA+600    WT-EDT COMMAND COUNT TEMP SAVE
CPCMSAV  EQU   CPWA+604    WT-EDT COMMAND TEMP SAVE (NOT TYPED)
* CPCTSAV & CPCMSAV USED BY EXEC TO KEEP UNPRESSED COMMANDS
         SPACE ,
CPCHECK  DC    X'6913723F'             CHECK FOR OVERFLOW
         SPACE ,
CPSIZE   EQU   3016   1952 1584        SIZE OF CONTROL PAGE
         SPACE ,
CPTNPG   EQU   (CPAREA+2*CPSIZE-*)/6   TOTAL NO. OF DIRECTORY ENTRIES
         SPACE ,
CPDREC   DS    0X                      START OF DIRECTORY
CPRCVSZ3 EQU   CPSTART+CPSIZE-CPDREC   1ST DIRECTORY SIZE
         SPACE ,
         ORG   CPSTART+2*CPSIZE
./ ADD NAME=DAIRINT,SSI=00000168
         TITLE  'DAIR DEFAULT PARAMS FOR INTRDR'
DAIRINT  DS    0F
DAIR30   DC    X'0030'
         DC    X'0000'
         DC    X'00000000'
         DC    F'0'
         DC    CL8'WYLRDR'
         DC    CL8' '
         DC    CL8' '
         DC    F'80'
         DC    F'0'
         DC    F'0'
DAIRWTR  DC    CL8'INTRDR'
         DC    CL4' '
         DC    XL3'000000'
         DC    X'80'
         DC    CL8' '
         DS    0F
DAIR18   DC    X'0018'
         DC    X'0000'
         DC    X'0000'
         DC    X'0000'
         DC    AL4(0)
         DC    CL8'WYLRDR'
         DC    CL8' '
         DC    C'O'
         DC    X'0'
         DC    X'0'
         DC    X'0'
         DC    8X'0'
DAINTSZ  EQU   *-DAIRINT
WYLRDR   ACB   DDNAME=WYLRDR,MACRF=(ADR,SEQ,OUT)
RPL      RPL   ACB=WYLRDR,RECLEN=255,OPTCD=(ADR,SEQ,SYN,NUP),          X
               AREA=BUF,AREALEN=255,CCHAR=CCHAR
ECB      DC    F'0'
BUF      DC    CL255' '
CCHAR    DC    C' '
./ ADD NAME=PIOB
PIOBSTRT DS    0D
PIOBFLG1 DC    X'42'
         DC    X'00'
PIOBSNS  DC    X'0000'
         DC    X'00'
PIOBECB  DC    AL3(PECB)
PIOBCSW  DC    2A(0)
         DC    X'00'
PIOBCCW  DC    AL3(PCCWS)
         DC    X'00'
PIOBDCB  DC    AL3(0)
         DC    2A(0)
PSEEK1   DC    XL8'0'
PSEEKREC EQU   PSEEK1+7
PSEEK2   DC    XL8'0'
PSEEK3   DC    XL8'0'
PSEEK4   DC    XL8'0'
PCCWS    DS    0D
PCCWSID1 CCW   X'31',PSEEK1+3,X'40',5
PCCWTIC1 CCW   X'08',*-8,0,0
PCCWWRT1 CCW   X'05',0,X'40',CPSIZE      JCBWAPTR
PCCWSID2 CCW   X'31',PSEEK2+3,X'40',5
PCCWTIC2 CCW   X'08',*-8,0,0
PCCWWRT2 CCW   X'05',0,X'40',CPSIZE      JCBWAPTR+CPSIZE
PCCWSID3 CCW   X'31',PSEEK3+3,X'40',5
PCCWTIC3 CCW   X'08',*-8,0,0
PCCWWRT3 CCW   X'05',0,X'40',CPSIZE      2ND CP PAGE
PCCWSID4 CCW   X'31',PSEEK4+3,X'40',5
PCCWTIC4 CCW   X'08',*-8,0,0
PCCWWRT4 CCW   X'05',0,0,CPSIZE          VCP
PECB     DC    A(0)
         DS    0D
PIOBSIZE EQU   *-PIOB
./ ADD NAME=VCPTSO,SSI=00000168
DVCP     DSECT
VCP#SVAR EQU   16                 # OF STRING VARIABLES
VCPR     EQU   9                  BASE REG
VCPWVAR  DS    XL64               LINE # AREA
VCPLVAR  EQU   VCPWVAR
VCPNVAR  DS    XL64               INTEGER AREA
VCPSVAR  DS    XL1380             STRING AREA
VCPLSVA  EQU   *-VCPSVAR          LENGTH OF STRING AREA
VCPLNG   EQU   *-DVCP
VCPPVAR  DS    XL600           USE FOR PFK'S
VCPSPVA  EQU   *-VCPPVAR       SIZE OF PFK AREA
./ ADD NAME=WDIOWA   0102-80182-80218-0926-00371-00371-00000-$SYS13  00
         MACRO
&NM      WDIOWA &TYPE
         SPACE ,
         AIF   ('&TYPE' EQ '').NOSECT
         AIF   ('&TYPE'(1,1) EQ 'C').CSECT
         AIF   ('&TYPE'(1,1) EQ 'D').DSECT
         MNOTE 4,'&TYPE INVALID - IGNORED'
         AGO   .NOSECT
.DSECT   ANOP
&NM      DSECT
         AGO   .START
.CSECT   ANOP
&NM      CSECT
         AGO   .START
.NOSECT  ANOP
&NM      DS    0D
.START   ANOP
*                                                               JEP013
*                                                               JEP013
* MOD JEP013                                                    JEP013
*  CHANGED DEFAULT NAME FROM WYL.CU.CTR.VTOC TO FDRABR  ITEL    JEP013
*  DENOTED JEP013 IN 66/71.  JERRY PITTENGER                    JEP013
*                                                               JEP013
         SPACE 2
         DS    0D
WADECB   DC    AL1(255),AL3(DECB)
UCB      DC    A(0)      UCB ADDR FOR SPEC VOLUME
         SPACE
DFL      DC    X'00'     FLAGS
         SPACE ,
DFREPL   EQU   X'08'     STOW REPL TO BE DONE AT CLOSE
DFUPTSPC EQU   X'02'     UPDATE SPACE ACCTG AT CLOSE
DFUSPCNM EQU   X'01'     NO COND SHOW SPACE CALL IF ON
         SPACE 2
FLAGS    DS    CL5       SAVE DSNAME FLAGS
F1       EQU   FLAGS          FIRST DSNAME FLAG
F2       EQU   FLAGS+1        SECOND DSNAME FLAG
F3       EQU   FLAGS+2        THIRD DSNAME FLAG
F4       EQU   FLAGS+4        FOURTH DSNAME FLAG
F5       EQU   FLAGS+5        FIFTH DSNAME FLAG
         SPACE ,
DSDD     DC    CL8'IOVVVVVV'  DDNAME
         SPACE 2
* EXLST FOR DCB
EXLST    DS    0F
         DC    X'00'               ENTRY TO BE FILLED IN
         DC    AL3(0)
         DC    X'87'               LAST ENTRY/JFCB POINTER
         DC    AL3(JFCB)
         SPACE 2
* IOB FOR EXCP
IOB      DS    0D
         DC    XL2'C200'
IOBSNS   DC    H'0'
         DC    A(DECB)
IOBCSW   DC    2F'0'
IOBSTART DC    F'0'
         DC    A(FOURS)       DCB
         DC    2F'0'
         DC    XL1'0'
IOBB     DC    XL2'0'
SEEK     DC    XL5'0'
         SPACE 2
* CHANNEL PROGRAM FOR EXCP
MT       EQU   X'80'          MULTI-TRACK
SCHIDEQ  EQU   X'31'          SEARCH ID EQUAL
TIC      EQU   X'08'          XFER IN CHANNEL
SCHKYEQ  EQU   X'29'          SEARCH KEY EQUAL
SCHKYHI  EQU   X'49'          SEARCH KEY HIGH
SCHKYHE  EQU   X'69'          SEARCH KEY HI OR EQUAL
SCHKADEQ EQU   X'2D'          SEARCH KEY AND DATA EQUAL
SCHKADHI EQU   X'4D'          SEARCH KEY AND DATA HIGH
SCHKADHE EQU   X'6D'          SEARCH KEY AND DATA HI OR EQUAL
SWKADKY  EQU   SCHKADHE-SCHKYHE    USED TO SWAP SCH KAD/SCH KEY
RDCNT    EQU   X'12'          READ COUNT
RDDATA   EQU   X'06'          READ DATA
RDKYDATA EQU   X'0E'          READ KEY AND DATA
NOPIC    EQU   X'03'          NOP IN CHANNEL
CC       EQU   X'40'          COMMAND CHAIN
DC       EQU   X'80'          DATA CHAIN
SLI      EQU   X'20'          SLI
SKP      EQU   X'10'          SKIP DATA XFER
         SPACE ,
SRCHCCW  CCW   SCHIDEQ,SEEK,CC+SLI,5         SEARCH FOR PREV REC
         CCW   TIC,SRCHCCW,CC+SLI,0
CCWSW    CCW   TIC,ID,CC+SLI,0               SWITCH BETWEEN ID & PDSRD
ID       CCW   SCHIDEQ+MT,ENDTEST,CC+SLI,5   LAST VTOC REC?
         CCW   TIC,KEY,CC+SLI,0              TIC IF NO
         CCW   TIC,ENDCCW1,CC+SLI,0          TIC IF YES
*              LENGTH FIELD IS CHANGED IN FOLLOWING CCW
KEY      CCW   SCHKADEQ+MT,DSNAME,CC+SLI,0   IS REC ONE WE WANT?
         CCW   TIC,ID,CC+SLI,0               TIC IF NO
         CCW   RDCNT+MT,SRCHC,SLI,5          READ ADDR OF FOLL REC
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
*              LENGTH FIELD IS CHANGED IN FOLLOWING CCW
ENDCCW1  CCW   SCHKADEQ,DSNAME,CC+SLI,0  IS LAST VTOC REC ONE WE WANT?
         CCW   TIC,ENDCCW,CC+SLI,0       TIC IF NO
         CCW   NOPIC,SEEK,CC+SLI+SKP,1   DUMMY CMND
ENDCCW2  CCW   SCHIDEQ,ENDTEST,CC+SLI,5  SO WE CAN SEARCH AGAIN
         CCW   TIC,ENDCCW2,CC+SLI,0
READCCW2 CCW   RDKYDATA,DS1DSNAM,SLI,DS1END-DS1DSNAM  READ DSCB
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
ENDCCW   CCW   NOPIC,SEEK,SLI,1      DUMMY CMD TO FLAG END OF SEARCH
* IF FINAL CSW POINTS HERE THEN THE VTOC HAS BEEN COMPLETELY SEARCHED
         SPACE ,
* CHANNEL PROGRAM RESTARTED HERE IF A RECORD FOUND WE WANT
READCCW  CCW   SCHIDEQ,SRCHC,CC+SLI,5     SEARCH FOR THE ONE WE WANTED
         CCW   TIC,READCCW,CC+SLI,0
         CCW   RDKYDATA,DS1DSNAM,SLI,DS1END-DS1DSNAM    READ DSCB
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
* CHANNEL PROGRAM SECTION FOR READING PDS DIRECTORY
PDSREAD  CCW   RDCNT+MT,SRCHC,CC+SLI,5
         CCW   RDKYDATA,DBUF,SLI,264
         SPACE 3
* MISCELLANEOUS WORK AREAS AND CONSTANTS
CCREDT   DS    D
DSNAME   DS    CL44
DSN      DC    44X'04'
         SPACE ,
BLDL     DS    0F
         DC    H'1'           ONE ENTRY
         DC    AL2(BLDLSZ)    LENGTH OF ENTRY
MEMBER   DS    CL8            MEMBER NAME
BLDLTTR  DS    CL3            MEMBER TTR
BLDLKZC  DS    CL3            OTHER BLDL TRASH
BLDLSZ   EQU   *-MEMBER
         ORG   BLDLKZC+1      STOW REQUIRES C BUT NOT K AND Z
STOWLTTR DS    F              DATE OF LAST STOW OR SSI
STOWSZ   EQU   *-MEMBER       SIZE OF DIRECTORY ENTRY STOWED
         SPACE ,
RRECFM   DS    CL1            RECFM
         SPACE ,
SCRVLST  DS    0F             SCRATCH LIST AND OTHERS
         DC    H'1'           NUMBER OF VOLUMES
DEVCODE  DS    CL4            RESULT OF DEVTYPE
DSVID    DS    CL6            VOLUME ID
         DC    X'0'           BYTE OF ZERO
SCRRET   DC    X'0'           RETURN CODE FROM SCRATCH
         SPACE 3
VTOCCCW  DC    AL3(ID)        TIC ADDR FOR SHOW DSNAMES
PDSCCW   DC    AL3(PDSREAD)   TIC ADDR FOR SHOW DIRECTORY
LASTCCW  DC    AL3(ENDCCW+8)  ADDR IN CSW WHEN VTOC SEARCH DONE
LASTCCW1 DC    AL3(ENDCCW)    ADDR IN CSW WHEN LAST VTOC REC WANTED
RECSIZE  DS    F
LRECSIZE DS    F
ERROR    DS    F
SPACE    DS    F
DEVBLOCK DS    F              DEVICE BLOCK SIZE
RETCOD   DS    F
         EJECT
* DECBS AND PARAMTER LISTS
         SPACE ,
         READ  DECB,SF,DCB,DBUF,MF=L
         SPACE 3
DSCB     CAMLST SEARCH,DSNAME,DSVID,DS1FMTID
         SPACE 3
SCRLST   CAMLST SCRATCH,DSNAME,,SCRVLST
         SPACE 3
USCATL   CAMLST NAME,DSNAME,,CATBLOCK
         SPACE 3
USCATL2  CAMLST BLOCK,CATNTTR,CATVOLID,CATBLOCK
CAMVOLID EQU   USCATL2+8      ADDR OF VOLUME ID PTR IN PREV LIST A26
         SPACE 3
VTOC     CAMLST SEARCH,DSN,DSVID,VTOCAREA
         SPACE 3
VTOC3    CAMLST SEEK,DS1PTRDS,DSVID,IECSDSL3
         SPACE 3
CATLST   CAMLST CAT,DSNAME,,SCRVLST     USED FOR CAT/UNCAT/RECAT
         SPACE 3
OPENLIST OPEN  (DCB),MF=L
         SPACE 3
ENQDSN   ENQ   (,DSNAME,,,SYSTEM),RET=USE,MF=L
         EJECT
* DUMMY  DCBS
         SPACE 2
* DUMMY DCB TO ALLOCATE SPACE FOR DCB TO BE MOVED IN
DCB      DCB   DSORG=PS,MACRF=(RP,WP)
         EJECT
FOURS    DCB   DSORG=PS,MACRF=E,EXLST=EXLST
         EJECT
***  THE DATA BUFFER IS ALSO USED AS A WORK AREA AND FOR READING
**    VARIOUS CONTROL BLOCKS.  IT IS CAREFULLY CONSTRUCTED SO
**    THAT AREAS WHICH ARE REQUIRED SIMULTANEOUSLY DO NOT OVERLAY
**    EACH OTHER.  THE OVERLAY STRUCTURE IS AS FOLLOWS:
*
**   DBUF      FMT 4 DSCB WORK AREA
**     |       SHOW DSNAMES WORK AREA
**     |       JFCB AREA
**     |       LOCATE VOL WORK AREA
**     |       REST OF CATLG BLOCK AREA      DSCB1/3/5 WORK AREAS
**     |                 |                            V
**     |                 V
**     |       SHOW DSNAMES BUFFER           SHOW CATLG BUFFER
**     |                 |                   CLEAR JFCB WORK AREA
**     |                 V                            |
**     |                                              V
**     |                                     SUBTASK R13 REG SV AREA
**     |                                              V
**     |
**     V
         SPACE 3
* DAIR INTERFACE:
WAUPT    DC    A(0)
WAECT    DC    A(0)
WAECB    DC    A(WADARECB)
WAPSCB   DC    A(0)
WADAIR   DC    A(DA08CD)
WADARECB DC    F'0'
DAIRDSN  DC    AL2(44)                                         JJGP013
DSNPREF  DC    CL9'DPC1.VOL.'                                  JJG
DSNVOL   DC    CL6' '                                          JJG
         DC    CL29' '                                         JJG
***********************************************************************
* THIS OPERATION CODE CAUSES ALLOCATION OF A DATA SET. IT CAN ALLOC.  *
* EITHER A NEW OR OLD SET.                                            *
***********************************************************************
         DS    0F
DA08CD   DC    AL2(8)   DAIR ENTRY CODE
DA08FLG  DC    X'00'    FUNCTIONS TO BE PERFORMED WHEN RET CODE IS 0
DA08FPE  EQU   X'80'    FUNCT PERFORMED BUT ERROR INDICATED BY RETCD
         DC    X'00'
DA08DARC DC    H'0'     DYN ALLOC RETURN CODE
DA08CTRC DC    H'0'     CATALOG RETURN CODE
DA08PDSN DC    A(DAIRDSN)   PTR TO DSNAME TO BE SEARCHED IN DSE
DA08DDN  DC    CL8' '   DDNAME TO BE SEARCHED IN DSE
DA08UNIT DC    CL8' '   UNITNAME REQUESTED
DA08SER  DC    CL8' '   VOLUME SERIAL NUMBER-PADDED W/BLANKS
DA08BLK  DC    F'0'     DATA SET  AVERAGE RECORD LENGTH
DA08PQTY DC    F'0'     PRIMARY SPACE QUANTITY
DA08SQTY DC    F'0'     SECONDARY SPACE QUANTITY
DA08DQTY DC    F'0'     DIRECTORY BLOCK QUANTITY
DA08MNM  DC    CL8' '   MEMBER NAME
DA08PSWD DC    CL8' '   PASSWORD
DA08DSP1 DC    X'08'    DATA SET STATUS FLGS(IF=0 OLD ASSUMED)
DA08SHR  EQU   X'08'    DATA SET IS SHR
DA08NEW  EQU   X'04'    DATA SET IS NEW
DA08MOD  EQU   X'02'    DATA SET IS MOD
DA08OLD  EQU   X'01'    DATA SET IS OLD
DA08DPS2 DC    X'08'    DATA SET DISPOSITION(IF=0 KEEP ASSUMED)
DA08KEEP EQU   X'08'    DS DISP IS KEEP
DA08DEL  EQU   X'04'    DS DISP IS DELETE
DA08CAT  EQU   X'02'    DS DISP IS CATLG
DA08UCAT EQU   X'01'    DS DISP IS UNCATALOG
DA08DPS3 DC    X'08'    DATA SET CONDITIONAL DISPOSITION
DA08KEP  EQU   X'08'
DA08DELE EQU   X'04'
DA08CATL EQU   X'02'    DS DISP OF CATLG DESIRED
DA08UNCT EQU   X'01'    DS DISP OF UNCATLG DESIRED
DA08CTL  DC    X'08'    FLAGS TO CONTROL ACTIONS TAKEN BY DAIR
DA08TRKS EQU   X'80'    UNITS ARE TRKS
DA08ABKL EQU   X'40'
DA08CYLS EQU   X'C0'    UNITS ARE CYLS
DA08UID  EQU   X'20'    USER ID IS TO BE PREFIXED
DA08RLSE EQU   X'10'    RELEASE (RLSE) REQUESTED
DA08PERM EQU   X'08'    DATA SET MUST BE SPECIFICALLY UNALLOCATED
DA08DMMY EQU   X'04'
DA08ATRL EQU   X'02'    ATTRIBUTE LIST SUPPLIED
         DC    XL3'00'  RESERVED
DA08DSO  DC    XL1'00'  DSORG
DA08ALN  DC    CL8' '   ATTR-LIST-NAME
***********************************************************************
* THIS OPERATION CAUSES THE REQUESTED DATA SET OR DDNAME TO BE        *
* UNALLOCATED. DISPOSITION CAN BE SPECIFIED TO OVERRIDE ANY PREVIOUS  *
* DISPOSITION. LIKENISE SYSOUT CLASS MAY BE SPECIFIED TO OVERRIDE ANY *
* PREVIOUS CLASS.                                                     *
***********************************************************************
         DS    0F
DA18CD   DC    AL2(24)  DAIR ENTRY CODE
DA18FLG  DC    X'00'    FUNCTIONS TO BE PERFORMED WHEN RET CODE IS 0
DA18FPE  EQU   X'80'    FUNCT PERFORMED BUT ERROR INDICATED BY RETCD
         DC    X'00'
DA18DARC DC    H'0'                    DYNAMIC ALLOCATION RETURN CODE
DA18CTRC DC    H'0'               CATALOG RETURN CODE AREA
DA18PDSN DC    A(0)         PTR TO DSNAME TO BE SEARCHED IN DSE
DA18DDN  DC    CL8' '   DDNAME TO BE SEARCHED IN DSE
DA18MNM  DC    CL8' '   MEMBER NAME
DA18SCLS DC    CL2' '   SYSOUT CLASS DESIRED WHEN UNALLOCATING  A
*                       SYSOUT DATA SET
DA18DPS2 DC    X'08'    DATA SET DISPOSITION
DA18KEEP EQU   X'08'    CHANGE DISP TO KEEP
DA18DEL  EQU   X'04'    CHANGE DISP TO DELETE
DA18CAT  EQU   X'02'    CHANGE DISP TO CATALOG
DA18UCAT EQU   X'01'    CHANGE DISP TO UNCATLOG
DA18CTL  DC    X'10'    FLAGS FOR SPECIAL DAIR PROCESSING
DA18UID  EQU   X'20'    USER ID IS TO BE PREFIXED TO DSNAME
DA18PERM EQU   X'10'    UNALLOCATE PERM. ALLOCATED DSE'S
DA18JBNM DC    CL8' '
         SPACE ,
ATTDECB  DC   A(0)                 ECB FOR ATTACH
WATTACH  ATTACH EP=IKJEFT01,ECB=ATTDECB,SF=L
         DS    0F
WASTAX   DC    5A(0)               STAX PARAMETER LIST
DBUF     DS    0D
DBUFSIZE EQU   19069
ACCTWA   EQU   DBUF       ACCOUNTING WORK AREA
         DS    (DBUFSIZE)C
         SPACE 3
* WORK AREA FOR DVTOC
         SPACE ,
* FIRST PART IS FORMAT 4 DSCB AREA
         ORG   DBUF
VTOCAREA DS    0D
         IECSDSL1 4
         ORG   DS4VTOCE       FMT 4 EXTENT DESCRIPTION
         DS    CL2
VTOCBEG  DS    CL4
VTOCEND  DS    CL4
         DS    279C
         SPACE 3
PAGEGET  DS    F
VTOCSV   DS    11F
WAR14    EQU   VTOCSV    REG SAVE AREA FOR SUBTASK COMMUNICATION
WAR15    EQU   WAR14+4
*
ENDTEST  DS    XL5
*
*
DVTAREA  DVTAREA ,                 DEFINE DEVCODE AREA
*
*
NUMTRK   DS    H
*
SRCHC    DS    H
SRCHH    DS    H
SRCHR    DS    H
         EJECT
JFCB     DS    0D
         IEFJFCBN
         EJECT
* VOLUME CATALOG ENTRY WORK AREA
         SPACE ,
CATBLOCK DS    0D
CATNOENT DS    H
CATDVTYP DS    CL4
CATVOL   DS    CL6
CATTRASH DS    CL2
CATENTSZ EQU   *-CATDVTYP
CATNTTR  EQU   CATBLOCK+256        TTR OF BLOCK FOLL READ BLOCK
CATVOLID EQU   CATNTTR+3           VOL ID OF CATLG
CATRSIZE EQU   CATVOLID+6-CATBLOCK SIZE READ FROM CATLG
         SPACE 3
* FORMAT 1 DSCB WORK AREA
         DS    0D
         IECSDSL1 1
DS1END   EQU   *
SPACFLAG EQU   X'69'          SPACE ACCOUNTING FLAG BITS
         SPACE 3
* FORMAT 3 DSCB WORK AREA
         ORG   IECSDSL1
         DS    0D
         IECSDSL1 3
DS3END   EQU   *
         SPACE 3
* FORMAT 5 DSCB WORK AREA
         ORG   IECSDSL1
         IECSDSL1 5
         SPACE 3
         ORG   CATBLOCK+CATRSIZE   (MUST BE .GT. DS3END)
         COPY  SDSNBUF
         SPACE 3
         COPY  SCATBUF
         SPACE 3
JFCBSAVE DS    0D
         DS    CL(JFCBLGTH)
         SPACE 3
WASA     DS    18F       R13 SAVE AREA DURING SUBTASK
         ORG   ,
         MEND
./ ADD NAME=WDIOWA9  0100-80182-80182-1753-00371-00371-00000-$SYS13  00
         MACRO
&NM      WDIOWA &TYPE
         SPACE ,
         AIF   ('&TYPE' EQ '').NOSECT
         AIF   ('&TYPE'(1,1) EQ 'C').CSECT
         AIF   ('&TYPE'(1,1) EQ 'D').DSECT
         MNOTE 4,'&TYPE INVALID - IGNORED'
         AGO   .NOSECT
.DSECT   ANOP
&NM      DSECT
         AGO   .START
.CSECT   ANOP
&NM      CSECT
         AGO   .START
.NOSECT  ANOP
&NM      DS    0D
.START   ANOP
*                                                               JEP013
*                                                               JEP013
* MOD JEP013                                                    JEP013
*  CHANGED DEFAULT NAME FROM WYL.CU.CTR.VTOC TO FDRABR  ITEL    JEP013
*  DENOTED JEP013 IN 66/71.  JERRY PITTENGER                    JEP013
*                                                               JEP013
         SPACE 2
         DS    0D
WADECB   DC    AL1(255),AL3(DECB)
UCB      DC    A(0)      UCB ADDR FOR SPEC VOLUME
         SPACE
DFL      DC    X'00'     FLAGS
         SPACE ,
DFREPL   EQU   X'08'     STOW REPL TO BE DONE AT CLOSE
DFUPTSPC EQU   X'02'     UPDATE SPACE ACCTG AT CLOSE
DFUSPCNM EQU   X'01'     NO COND SHOW SPACE CALL IF ON
         SPACE 2
FLAGS    DS    CL5       SAVE DSNAME FLAGS
F1       EQU   FLAGS          FIRST DSNAME FLAG
F2       EQU   FLAGS+1        SECOND DSNAME FLAG
F3       EQU   FLAGS+2        THIRD DSNAME FLAG
F4       EQU   FLAGS+4        FOURTH DSNAME FLAG
F5       EQU   FLAGS+5        FIFTH DSNAME FLAG
         SPACE ,
DSDD     DC    CL8'IOVVVVVV'  DDNAME
         SPACE 2
* EXLST FOR DCB
EXLST    DS    0F
         DC    X'00'               ENTRY TO BE FILLED IN
         DC    AL3(0)
         DC    X'87'               LAST ENTRY/JFCB POINTER
         DC    AL3(JFCB)
         SPACE 2
* IOB FOR EXCP
IOB      DS    0D
         DC    XL2'C200'
IOBSNS   DC    H'0'
         DC    A(DECB)
IOBCSW   DC    2F'0'
IOBSTART DC    F'0'
         DC    A(FOURS)       DCB
         DC    2F'0'
         DC    XL1'0'
IOBB     DC    XL2'0'
SEEK     DC    XL5'0'
         SPACE 2
* CHANNEL PROGRAM FOR EXCP
MT       EQU   X'80'          MULTI-TRACK
SCHIDEQ  EQU   X'31'          SEARCH ID EQUAL
TIC      EQU   X'08'          XFER IN CHANNEL
SCHKYEQ  EQU   X'29'          SEARCH KEY EQUAL
SCHKYHI  EQU   X'49'          SEARCH KEY HIGH
SCHKYHE  EQU   X'69'          SEARCH KEY HI OR EQUAL
SCHKADEQ EQU   X'2D'          SEARCH KEY AND DATA EQUAL
SCHKADHI EQU   X'4D'          SEARCH KEY AND DATA HIGH
SCHKADHE EQU   X'6D'          SEARCH KEY AND DATA HI OR EQUAL
SWKADKY  EQU   SCHKADHE-SCHKYHE    USED TO SWAP SCH KAD/SCH KEY
RDCNT    EQU   X'12'          READ COUNT
RDDATA   EQU   X'06'          READ DATA
RDKYDATA EQU   X'0E'          READ KEY AND DATA
NOPIC    EQU   X'03'          NOP IN CHANNEL
CC       EQU   X'40'          COMMAND CHAIN
DC       EQU   X'80'          DATA CHAIN
SLI      EQU   X'20'          SLI
SKP      EQU   X'10'          SKIP DATA XFER
         SPACE ,
SRCHCCW  CCW   SCHIDEQ,SEEK,CC+SLI,5         SEARCH FOR PREV REC
         CCW   TIC,SRCHCCW,CC+SLI,0
CCWSW    CCW   TIC,ID,CC+SLI,0               SWITCH BETWEEN ID & PDSRD
ID       CCW   SCHIDEQ+MT,ENDTEST,CC+SLI,5   LAST VTOC REC?
         CCW   TIC,KEY,CC+SLI,0              TIC IF NO
         CCW   TIC,ENDCCW1,CC+SLI,0          TIC IF YES
*              LENGTH FIELD IS CHANGED IN FOLLOWING CCW
KEY      CCW   SCHKADEQ+MT,DSNAME,CC+SLI,0   IS REC ONE WE WANT?
         CCW   TIC,ID,CC+SLI,0               TIC IF NO
         CCW   RDCNT+MT,SRCHC,SLI,5          READ ADDR OF FOLL REC
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
*              LENGTH FIELD IS CHANGED IN FOLLOWING CCW
ENDCCW1  CCW   SCHKADEQ,DSNAME,CC+SLI,0  IS LAST VTOC REC ONE WE WANT?
         CCW   TIC,ENDCCW,CC+SLI,0       TIC IF NO
         CCW   NOPIC,SEEK,CC+SLI+SKP,1   DUMMY CMND
ENDCCW2  CCW   SCHIDEQ,ENDTEST,CC+SLI,5  SO WE CAN SEARCH AGAIN
         CCW   TIC,ENDCCW2,CC+SLI,0
READCCW2 CCW   RDKYDATA,DS1DSNAM,SLI,DS1END-DS1DSNAM  READ DSCB
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
ENDCCW   CCW   NOPIC,SEEK,SLI,1      DUMMY CMD TO FLAG END OF SEARCH
* IF FINAL CSW POINTS HERE THEN THE VTOC HAS BEEN COMPLETELY SEARCHED
         SPACE ,
* CHANNEL PROGRAM RESTARTED HERE IF A RECORD FOUND WE WANT
READCCW  CCW   SCHIDEQ,SRCHC,CC+SLI,5     SEARCH FOR THE ONE WE WANTED
         CCW   TIC,READCCW,CC+SLI,0
         CCW   RDKYDATA,DS1DSNAM,SLI,DS1END-DS1DSNAM    READ DSCB
* END OF THIS PART OF COMMAND CHAIN
         SPACE 2
* CHANNEL PROGRAM SECTION FOR READING PDS DIRECTORY
PDSREAD  CCW   RDCNT+MT,SRCHC,CC+SLI,5
         CCW   RDKYDATA,DBUF,SLI,264
         SPACE 3
* MISCELLANEOUS WORK AREAS AND CONSTANTS
CCREDT   DS    D
DSNAME   DS    CL44
DSN      DC    44X'04'
         SPACE ,
BLDL     DS    0F
         DC    H'1'           ONE ENTRY
         DC    AL2(BLDLSZ)    LENGTH OF ENTRY
MEMBER   DS    CL8            MEMBER NAME
BLDLTTR  DS    CL3            MEMBER TTR
BLDLKZC  DS    CL3            OTHER BLDL TRASH
BLDLSZ   EQU   *-MEMBER
         ORG   BLDLKZC+1      STOW REQUIRES C BUT NOT K AND Z
STOWLTTR DS    F              DATE OF LAST STOW OR SSI
STOWSZ   EQU   *-MEMBER       SIZE OF DIRECTORY ENTRY STOWED
         SPACE ,
RRECFM   DS    CL1            RECFM
         SPACE ,
SCRVLST  DS    0F             SCRATCH LIST AND OTHERS
         DC    H'1'           NUMBER OF VOLUMES
DEVCODE  DS    CL4            RESULT OF DEVTYPE
DSVID    DS    CL6            VOLUME ID
         DC    X'0'           BYTE OF ZERO
SCRRET   DC    X'0'           RETURN CODE FROM SCRATCH
         SPACE 3
VTOCCCW  DC    AL3(ID)        TIC ADDR FOR SHOW DSNAMES
PDSCCW   DC    AL3(PDSREAD)   TIC ADDR FOR SHOW DIRECTORY
LASTCCW  DC    AL3(ENDCCW+8)  ADDR IN CSW WHEN VTOC SEARCH DONE
LASTCCW1 DC    AL3(ENDCCW)    ADDR IN CSW WHEN LAST VTOC REC WANTED
RECSIZE  DS    F
LRECSIZE DS    F
ERROR    DS    F
SPACE    DS    F
DEVBLOCK DS    F              DEVICE BLOCK SIZE
RETCOD   DS    F
         EJECT
* DECBS AND PARAMTER LISTS
         SPACE ,
         READ  DECB,SF,DCB,DBUF,MF=L
         SPACE 3
DSCB     CAMLST SEARCH,DSNAME,DSVID,DS1FMTID
         SPACE 3
SCRLST   CAMLST SCRATCH,DSNAME,,SCRVLST
         SPACE 3
USCATL   CAMLST NAME,DSNAME,,CATBLOCK
         SPACE 3
USCATL2  CAMLST BLOCK,CATNTTR,CATVOLID,CATBLOCK
CAMVOLID EQU   USCATL2+8      ADDR OF VOLUME ID PTR IN PREV LIST A26
         SPACE 3
VTOC     CAMLST SEARCH,DSN,DSVID,VTOCAREA
         SPACE 3
VTOC3    CAMLST SEEK,DS1PTRDS,DSVID,IECSDSL3
         SPACE 3
CATLST   CAMLST CAT,DSNAME,,SCRVLST     USED FOR CAT/UNCAT/RECAT
         SPACE 3
OPENLIST OPEN  (DCB),MF=L
         SPACE 3
ENQDSN   ENQ   (,DSNAME,,,SYSTEM),RET=USE,MF=L
         EJECT
* DUMMY  DCBS
         SPACE 2
* DUMMY DCB TO ALLOCATE SPACE FOR DCB TO BE MOVED IN
DCB      DCB   DSORG=PS,MACRF=(RP,WP)
         EJECT
FOURS    DCB   DSORG=PS,MACRF=E,EXLST=EXLST
         EJECT
***  THE DATA BUFFER IS ALSO USED AS A WORK AREA AND FOR READING
**    VARIOUS CONTROL BLOCKS.  IT IS CAREFULLY CONSTRUCTED SO
**    THAT AREAS WHICH ARE REQUIRED SIMULTANEOUSLY DO NOT OVERLAY
**    EACH OTHER.  THE OVERLAY STRUCTURE IS AS FOLLOWS:
*
**   DBUF      FMT 4 DSCB WORK AREA
**     |       SHOW DSNAMES WORK AREA
**     |       JFCB AREA
**     |       LOCATE VOL WORK AREA
**     |       REST OF CATLG BLOCK AREA      DSCB1/3/5 WORK AREAS
**     |                 |                            V
**     |                 V
**     |       SHOW DSNAMES BUFFER           SHOW CATLG BUFFER
**     |                 |                   CLEAR JFCB WORK AREA
**     |                 V                            |
**     |                                              V
**     |                                     SUBTASK R13 REG SV AREA
**     |                                              V
**     |
**     V
         SPACE 3
* DAIR INTERFACE:
WAUPT    DC    A(0)
WAECT    DC    A(0)
WAECB    DC    A(WADARECB)
WAPSCB   DC    A(0)
WADAIR   DC    A(DA08CD)
WADARECB DC    F'0'
DAIRDSN  DC    AL2(44)                                         JJGP013
DSNPREF  DC    CL9'GHI.PACK.'                                  JJG
DSNVOL   DC    CL6' '                                          JJG
         DC    CL29' '                                         JJG
***********************************************************************
* THIS OPERATION CODE CAUSES ALLOCATION OF A DATA SET. IT CAN ALLOC.  *
* EITHER A NEW OR OLD SET.                                            *
***********************************************************************
         DS    0F
DA08CD   DC    AL2(8)   DAIR ENTRY CODE
DA08FLG  DC    X'00'    FUNCTIONS TO BE PERFORMED WHEN RET CODE IS 0
DA08FPE  EQU   X'80'    FUNCT PERFORMED BUT ERROR INDICATED BY RETCD
         DC    X'00'
DA08DARC DC    H'0'     DYN ALLOC RETURN CODE
DA08CTRC DC    H'0'     CATALOG RETURN CODE
DA08PDSN DC    A(DAIRDSN)   PTR TO DSNAME TO BE SEARCHED IN DSE
DA08DDN  DC    CL8' '   DDNAME TO BE SEARCHED IN DSE
DA08UNIT DC    CL8' '   UNITNAME REQUESTED
DA08SER  DC    CL8' '   VOLUME SERIAL NUMBER-PADDED W/BLANKS
DA08BLK  DC    F'0'     DATA SET  AVERAGE RECORD LENGTH
DA08PQTY DC    F'0'     PRIMARY SPACE QUANTITY
DA08SQTY DC    F'0'     SECONDARY SPACE QUANTITY
DA08DQTY DC    F'0'     DIRECTORY BLOCK QUANTITY
DA08MNM  DC    CL8' '   MEMBER NAME
DA08PSWD DC    CL8' '   PASSWORD
DA08DSP1 DC    X'08'    DATA SET STATUS FLGS(IF=0 OLD ASSUMED)
DA08SHR  EQU   X'08'    DATA SET IS SHR
DA08NEW  EQU   X'04'    DATA SET IS NEW
DA08MOD  EQU   X'02'    DATA SET IS MOD
DA08OLD  EQU   X'01'    DATA SET IS OLD
DA08DPS2 DC    X'08'    DATA SET DISPOSITION(IF=0 KEEP ASSUMED)
DA08KEEP EQU   X'08'    DS DISP IS KEEP
DA08DEL  EQU   X'04'    DS DISP IS DELETE
DA08CAT  EQU   X'02'    DS DISP IS CATLG
DA08UCAT EQU   X'01'    DS DISP IS UNCATALOG
DA08DPS3 DC    X'08'    DATA SET CONDITIONAL DISPOSITION
DA08KEP  EQU   X'08'
DA08DELE EQU   X'04'
DA08CATL EQU   X'02'    DS DISP OF CATLG DESIRED
DA08UNCT EQU   X'01'    DS DISP OF UNCATLG DESIRED
DA08CTL  DC    X'08'    FLAGS TO CONTROL ACTIONS TAKEN BY DAIR
DA08TRKS EQU   X'80'    UNITS ARE TRKS
DA08ABKL EQU   X'40'
DA08CYLS EQU   X'C0'    UNITS ARE CYLS
DA08UID  EQU   X'20'    USER ID IS TO BE PREFIXED
DA08RLSE EQU   X'10'    RELEASE (RLSE) REQUESTED
DA08PERM EQU   X'08'    DATA SET MUST BE SPECIFICALLY UNALLOCATED
DA08DMMY EQU   X'04'
DA08ATRL EQU   X'02'    ATTRIBUTE LIST SUPPLIED
         DC    XL3'00'  RESERVED
DA08DSO  DC    XL1'00'  DSORG
DA08ALN  DC    CL8' '   ATTR-LIST-NAME
***********************************************************************
* THIS OPERATION CAUSES THE REQUESTED DATA SET OR DDNAME TO BE        *
* UNALLOCATED. DISPOSITION CAN BE SPECIFIED TO OVERRIDE ANY PREVIOUS  *
* DISPOSITION. LIKENISE SYSOUT CLASS MAY BE SPECIFIED TO OVERRIDE ANY *
* PREVIOUS CLASS.                                                     *
***********************************************************************
         DS    0F
DA18CD   DC    AL2(24)  DAIR ENTRY CODE
DA18FLG  DC    X'00'    FUNCTIONS TO BE PERFORMED WHEN RET CODE IS 0
DA18FPE  EQU   X'80'    FUNCT PERFORMED BUT ERROR INDICATED BY RETCD
         DC    X'00'
DA18DARC DC    H'0'                    DYNAMIC ALLOCATION RETURN CODE
DA18CTRC DC    H'0'               CATALOG RETURN CODE AREA
DA18PDSN DC    A(0)         PTR TO DSNAME TO BE SEARCHED IN DSE
DA18DDN  DC    CL8' '   DDNAME TO BE SEARCHED IN DSE
DA18MNM  DC    CL8' '   MEMBER NAME
DA18SCLS DC    CL2' '   SYSOUT CLASS DESIRED WHEN UNALLOCATING  A
*                       SYSOUT DATA SET
DA18DPS2 DC    X'08'    DATA SET DISPOSITION
DA18KEEP EQU   X'08'    CHANGE DISP TO KEEP
DA18DEL  EQU   X'04'    CHANGE DISP TO DELETE
DA18CAT  EQU   X'02'    CHANGE DISP TO CATALOG
DA18UCAT EQU   X'01'    CHANGE DISP TO UNCATLOG
DA18CTL  DC    X'10'    FLAGS FOR SPECIAL DAIR PROCESSING
DA18UID  EQU   X'20'    USER ID IS TO BE PREFIXED TO DSNAME
DA18PERM EQU   X'10'    UNALLOCATE PERM. ALLOCATED DSE'S
DA18JBNM DC    CL8' '
         SPACE ,
ATTDECB  DC   A(0)                 ECB FOR ATTACH
WATTACH  ATTACH EP=IKJEFT01,ECB=ATTDECB,SF=L
         DS    0F
WASTAX   DC    5A(0)               STAX PARAMETER LIST
DBUF     DS    0D
DBUFSIZE EQU   19069
ACCTWA   EQU   DBUF       ACCOUNTING WORK AREA
         DS    (DBUFSIZE)C
         SPACE 3
* WORK AREA FOR DVTOC
         SPACE ,
* FIRST PART IS FORMAT 4 DSCB AREA
         ORG   DBUF
VTOCAREA DS    0D
         IECSDSL1 4
         ORG   DS4VTOCE       FMT 4 EXTENT DESCRIPTION
         DS    CL2
VTOCBEG  DS    CL4
VTOCEND  DS    CL4
         DS    279C
         SPACE 3
PAGEGET  DS    F
VTOCSV   DS    11F
WAR14    EQU   VTOCSV    REG SAVE AREA FOR SUBTASK COMMUNICATION
WAR15    EQU   WAR14+4
*
ENDTEST  DS    XL5
*
*
DVTAREA  DVTAREA ,                 DEFINE DEVCODE AREA
*
*
NUMTRK   DS    H
*
SRCHC    DS    H
SRCHH    DS    H
SRCHR    DS    H
         EJECT
JFCB     DS    0D
         IEFJFCBN
         EJECT
* VOLUME CATALOG ENTRY WORK AREA
         SPACE ,
CATBLOCK DS    0D
CATNOENT DS    H
CATDVTYP DS    CL4
CATVOL   DS    CL6
CATTRASH DS    CL2
CATENTSZ EQU   *-CATDVTYP
CATNTTR  EQU   CATBLOCK+256        TTR OF BLOCK FOLL READ BLOCK
CATVOLID EQU   CATNTTR+3           VOL ID OF CATLG
CATRSIZE EQU   CATVOLID+6-CATBLOCK SIZE READ FROM CATLG
         SPACE 3
* FORMAT 1 DSCB WORK AREA
         DS    0D
         IECSDSL1 1
DS1END   EQU   *
SPACFLAG EQU   X'69'          SPACE ACCOUNTING FLAG BITS
         SPACE 3
* FORMAT 3 DSCB WORK AREA
         ORG   IECSDSL1
         DS    0D
         IECSDSL1 3
DS3END   EQU   *
         SPACE 3
* FORMAT 5 DSCB WORK AREA
         ORG   IECSDSL1
         IECSDSL1 5
         SPACE 3
         ORG   CATBLOCK+CATRSIZE   (MUST BE .GT. DS3END)
         COPY  SDSNBUF
         SPACE 3
         COPY  SCATBUF
         SPACE 3
JFCBSAVE DS    0D
         DS    CL(JFCBLGTH)
         SPACE 3
WASA     DS    18F       R13 SAVE AREA DURING SUBTASK
         ORG   ,
         MEND
